<canvas id="myCanvas" width="800" height="1000"></canvas>
<input type="time" id="timer" name="timer" onchange="manageTimer();">
<input type="button" id="now" name="now" value="Now" onclick="restart();">
<script>
    hourStep = Math.PI * 2 / 12;
    houtMinuteStep = hourStep / 60;
    minuteStep = Math.PI * 2 / 60;
    minuteSecondeStep = minuteStep / 60;
    canvas = document.getElementById("myCanvas");
    ctx = canvas.getContext("2d");
    timer = document.getElementById("timer");

    window.onload = function () {
        imgMontre = new Image();
        imgHeure = new Image();
        imgMinute = new Image();
        imgMontre.src = 'montre.png';
        imgHeure.src = 'heure.png';
        imgMinute.src = 'minute.png';


        interval = window.setInterval(draw, 1000);
    };

    function draw(time = 0) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "#03EFFF";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        drawImage(imgMontre);
        let now = new Date();
        if (time != 0) {
            console.log(22);
            now = new Date(now.toDateString() + ' ' + time);
        }
        drawImage(imgHeure, hourMinuteToAngle(now.getHours(), now.getMinutes()));

        drawImage(imgMinute, minuteToAngle(now.getMinutes(), now.getSeconds()));

    }

    function scalePreserveAspectRatio(imgW, imgH, maxW, maxH) {
        return (Math.min((maxW / imgW), (maxH / imgH)));
    }

    function drawImage(img, angle = 0) {

        ctx.save();
        let w = img.width;
        let h = img.height;

        let sizer = scalePreserveAspectRatio(w, h, canvas.width, canvas.height);

        if (angle) {
            ctx.translate((w * sizer) / 2, (h * sizer) / 2);
            ctx.rotate(angle);
            ctx.translate(-(w * sizer) / 2, -(h * sizer) / 2);
        }

        ctx.drawImage(img, 0, 0, w, h, 0, 0, w * sizer, h * sizer);
        ctx.restore();
    }


    function hourMinuteToAngle(hour, minute) {
        hour = (hour > 12) ? hour - 12 : hour;
        return hour * hourStep + minute * houtMinuteStep;
    }

    function minuteToAngle(minute, second) {
        return minute * minuteStep + second * minuteSecondeStep;
    }

    function manageTimer() {
        window.clearInterval(interval);
        draw(timer.value);

    }
    function restart(){
        draw();
        interval = window.setInterval(draw,1000);
    }
</script>
